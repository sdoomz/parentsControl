(function(){function e(e){this.name=e.name}function o(e,n,i){if(e.type=="update"){r.setValue(e.data);if(r.getValue("words")==null||r.getValue("language")!=e.data.language){t.sendRequest()}else{if(r.getValue("active")==true)u()}var s=confirm("You may need to reload page to update changes. Are you sure you want to reload page right now?");if(s){window.location.reload()}}}function u(){if(r.getValue("active")!=true){return false}var e=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,false);var t;var n=r.getValue("replacer");var i=r.getValue("words");if(r.getValue("userWords")!=""){i+="|"+r.getValue("userWords")}var s=a(i.split("|"));while(t=e.nextNode()){t.nodeValue=t.nodeValue.replace(s,n)}}function a(e,t){var e=e||r.getValue("words").split("|");var t=t||r.getValue("safeWords");if(t.length){var n=new RegExp("\\b("+t+")\\b","gi");for(var i=e.length-1;i>=0;i--){if(e[i].search(n)!=-1){e.splice(i,1)}}}return new RegExp("\\b("+e.join("|")+")\\b","gi")}function l(e){if(!f&&r.getValue("active")==true){setTimeout(function(){u();f=false},700)}f=true}e.prototype={getSettings:function(){var e=localStorage.getItem(this.name);return e?JSON.parse(e):{}},saveSettings:function(e){localStorage.setItem(this.name,JSON.stringify(e))},getValue:function(e){var t=this.getSettings();return t?t[e]:null},setValue:function(e,t){var n=this.getSettings();if(typeof e==="string"){n[e]=t;this.saveSettings(n)}else if(typeof e==="object"){for(var r in e){n[r]=e[r]}this.saveSettings(n)}else{return false}}};var t={};var n="_$webCensor";var r=new e({name:n});var i=r.getSettings();var s={language:i.language||"eng",words:i.words||"",userWords:i.userWords||"",safeWords:i.safeWords||"",replacer:i.replacer||"*****",active:i.hasOwnProperty("active")&&i.active!=null?i.active:true};r.saveSettings(s);chrome.runtime.sendMessage({type:"getLocal"},function(e){var t=JSON.parse(e);r.setValue(t)});chrome.runtime.onMessage.addListener(o);t.sendRequest=function(){var e=new XMLHttpRequest;e.open("GET",chrome.extension.getURL("words.json"),true);e.onreadystatechange=function(){if(e.readyState==4){if(e.status==200){var t=JSON.parse(e.responseText);var n=t[r.getValue("language")].join("|");r.setValue("words",n);if(r.getValue("active")==true)u()}}};e.send(null)};if(r.getValue("words")==""){t.sendRequest()}document.addEventListener("DOMSubtreeModified",l,false);var f=false})()